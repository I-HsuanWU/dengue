direction = "forward")
summary(model1)
#Kaohsiung 1-7 + IMPORT4-9(1VARIANT) AIC: 318.14(+)
setwd("~/weather data")
data <- read.csv("1998-2019 KaohsiungRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I4_9"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Kaohsiung <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','I4_9')
df$CASES <- local_Kaohsiung$L4_Kaohsiung
dfnew <- df
#Calculating AIC
model2 <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7  + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I4_9,
direction = "forward", family=poisson(link=log))
summary(model2)
res1 = residuals(model1, type = "deviance")
res2 = residuals(model2, type = "deviance")
par(mfrow = c(1,2))
qqnorm(res1)
qqnorm(res2)
#Calculating AIC
model<- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7  + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I4 + I5 + I6 + I7 ,
direction = "forward", family=poisson(link=log))
summary(model)
#Calculating AIC
modelA <- stepAIC(glm(CASES ~ 1, data = dfnew, family=poisson(link=log)),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7 ,
direction = "forward")
summary(modelA)
#Tainan 1-7 AIC: 204.67
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
}
df <- rbind(df, c(YEAR,1,T , R))
}
setwd("~/登革熱資料")
local_Tainan <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7')
df$CASES <- local_Tainan$L4_Tainan
dfnew <- df
#Calculating AIC
modelA <- stepAIC(glm(CASES ~ 1, data = dfnew, family=poisson(link=log)),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7 ,
direction = "forward")
summary(modelA)
#Tainan 1-7 + IMPORT6-9(1VARIANT) AIC: 315.35
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I6_9"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Kaohsiung <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','I6_9')
df$CASES <- local_Kaohsiung$L4_Tainan
dfnew <- df
#Calculating AIC
glm13 <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7  + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I6_9,
direction = "forward", family=poisson(link=log))
summary(glm13)
#Tainan 1-7 + IMPORT4-7 AIC: 315.35
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 4:7)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"IMPORT"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Tainan <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','0','0','0','I4','I5','I6','I7')
df$CASES <- local_Tainan$L4_Tainan
dfnew <- df
#Calculating AIC
model<- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7  + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I4 + I5 + I6 + I7 ,
direction = "forward", family=poisson(link=log))
summary(model)
#Tainan 1-7 + IMPORT4-7(1VARIANT) AIC: 286.72
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:8) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I4_7"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Kaohsiung <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','I4_7')
df$CASES <- local_Kaohsiung$L4_Tainan
dfnew <- df
#Calculating AIC
modelB <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I4_7,
direction = "forward", family=poisson(link=log))
summary(modelB)
#Tainan 1-7 + IMPORT5-8(1VARIANT) AIC: 315.35
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I5_8"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Kaohsiung <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','I5_8')
df$CASES <- local_Kaohsiung$L4_Tainan
dfnew <- df
#Calculating AIC
modelD <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7  + I5_8,
direction = "forward", family=poisson(link=log))
summary(modelD)
#Tainan 1-7 + IMPORT4-8(1VARIANT) AIC: 315.35
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I4_8"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料")
local_Kaohsiung <- read.csv("1999-2015 L4-Kaohsiung+Tainan.csv")
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','R1','R2','R3','R4','R5','R6','R7','I4_8')
df$CASES <- local_Kaohsiung$L4_Tainan
dfnew <- df
#Calculating AIC
modelW <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7  + I4_8,
direction = "forward", family=poisson(link=log))
summary(modelW)
#Calculating AIC
model2 <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7  + R1 + R2 + R3 + R4 + R5 + R6 + R7 + I4_9,
direction = "forward", family=poisson(link=log))
summary(model2)
res1 = residuals(model1, type = "deviance")
res2 = residuals(model2, type = "deviance")
par(mfrow = c(1,2))
qqnorm(res1)
qqnorm(res2)
setwd("~/登革熱資料")
# Creating Data Frame
data <- read.csv("1999-2016 Kaohsiung_local_average.csv", sep = ",", header = TRUE)
data_df=data
data_df$Month=month.abb[data_df$MONTH]
data_df$Month <- factor(data_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Local_Cases <- data_df$Local_average
Imported_Cases <- data_df$Import_average
# --> construct separate plots for each series
library(lattice)
Local_Cases <- xyplot(Local_Cases ~ Month, data_df, type = "l" , lwd=2)
Imported_Cases <- xyplot(Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Local_Cases, Imported_Cases, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
setwd("~/登革熱資料")
# Creating Data Frame
data1 <- read.csv("1999-2016 Kaohsiung_local_average.csv", sep = ",", header = TRUE)
data1_df=data1
data1_df$Month=month.abb[data1_df$MONTH]
data1_df$Month <- factor(data1_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Local_Cases1 <- data1_df$Local_average
Imported_Cases1 <- data1_df$Import_average
# --> construct separate plots for each series
library(lattice)
Local_Cases <- xyplot(Local_Cases ~ Month, data_df, type = "l" , lwd=2)
Imported_Cases <- xyplot(Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Local_Cases1, Imported_Cases1, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
setwd("~/登革熱資料")
# Creating Data Frame
data2 <- read.csv("1999-2016 Tainan_local_average.csv", sep = ",", header = TRUE)
data2_df=data
data2_df$Month=month.abb[data_df$MONTH]
data2_df$Month <- factor(data_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Local_Cases2 <- data_df$Local_average
Imported_Cases2 <- data_df$Import_average
# --> construct separate plots for each series
library(lattice)
Local_Cases2 <- xyplot(Local_Cases2 ~ Month, data_df, type = "l" , lwd=2)
Imported_Cases2 <- xyplot(Imported_Cases2 ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Local_Cases2, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
setwd("~/登革熱資料")
# Creating Data Frame
data1 <- read.csv("1999-2016 Kaohsiung_local_average.csv", sep = ",", header = TRUE)
data1_df=data1
data1_df$Month=month.abb[data1_df$MONTH]
data1_df$Month <- factor(data1_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Local_Cases <- data_df$Local_average
Imported_Cases <- data_df$Import_average
# --> construct separate plots for each series
library(lattice)
Local_Cases <- xyplot(Local_Cases ~ Month, data_df, type = "l" , lwd=2)
Imported_Cases <- xyplot(Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Imported_Cases1, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
# --> construct separate plots for each series
library(lattice)
Imported_Cases1 <- xyplot(Imported_Cases1~ Month, data1_df, type = "l" , lwd=2)
Imported_Cases2 <- xyplot(Imported_Cases2 ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Imported_Cases1, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
Imported_Cases2 <- data2_df$Import_average
doubleYScale(Local_Cases2, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
Imported_Cases2 <- xyplot(Imported_Cases2 ~ Month, data_df, type = "l" , lwd=2)
doubleYScale(Local_Cases2, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
Imported_Cases1 <- xyplot(Imported_Cases1~ Month, data1_df, type = "l" , lwd=2)
Imported_Cases2 <- xyplot(Imported_Cases2 ~ Month, data2_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Imported_Cases1, Imported_Cases2, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
setwd("~/登革熱資料")
# Creating Data Frame
data <- read.csv("1999-2016 Tainan_local_average.csv", sep = ",", header = TRUE)
data_df=data
data_df$Month=month.abb[data_df$MONTH]
data_df$Month <- factor(data_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Local_Cases <- data_df$Local_average
Imported_Cases <- data_df$Import_average
# --> construct separate plots for each series
library(lattice)
Local_Cases <- xyplot(Local_Cases ~ Month, data_df, type = "l" , lwd=2)
Imported_Cases <- xyplot(Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Local_Cases, Imported_Cases, text = c("Monthly Local Dengue Cases", "Monthly Imported Dengue Cases") , add.ylab2 = TRUE)
setwd("~/登革熱資料")
# Creating Data Frame
data <- read.csv("1999-2016 Kaohsiung_local_average.csv", sep = ",", header = TRUE)
data_df=data
data_df$Month=month.abb[data_df$MONTH]
data_df$Month <- factor(data_df$Month, levels=c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
# Changing the "Date" colomn class from 'Charcter' to 'Date' class
library(lubridate)
Kaohsiung_Imported_Cases <- data_df$Import_average_K
Tainan_Imported_Cases <- data_df$Import_average_T
# --> construct separate plots for each series
library(lattice)
Kaohsiung_Imported_Cases <- xyplot(Kaohsiung_Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
Tainan_Imported_Cases <- xyplot(Tainan_Imported_Cases ~ Month, data_df, type = "l" , lwd=2)
# --> Make the plot with second y axis:
library(RColorBrewer)
library(latticeExtra)
doubleYScale(Kaohsiung_Imported_Cases, Tainan_Imported_Cases, text = c("Monthly Kaohsiung Imported Dengue Cases", "Monthly Tainan Imported Dengue Cases") , add.ylab2 = TRUE)
#Tainan 1-8 AIC: 257.55
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:8) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
}
df <- rbind(df, c(YEAR,1,T , R))
}
setwd("~/???鞈??")
local_Tainan <- read.csv("local-Tainan.csv")
loca_yr_Tainan<- aggregate(local~year, data=local_Tainan, sum)
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','T8','R1','R2','R3','R4','R5','R6','R7','R8')
df$CASES <- loca_yr_Tainan$local
#Tainan 1-7 AIC: 257.55
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:7) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
}
df <- rbind(df, c(YEAR,1,T , R))
}
setwd("~/登革熱資料")
local_Tainan <- read.csv("local-Tainan.csv")
loca_yr_Tainan<- aggregate(local~year, data=local_Tainan, sum)
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7,'R1','R2','R3','R4','R5','R6','R7')
df$CASES <- loca_yr_Tainan$local
dfnew <- df
#Calculating AIC
modelA <- stepAIC(glm(CASES ~ 1, data = dfnew, family=poisson(link=log)),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + R1 + R2 + R3 + R4 + R5 + R6 + R7 ,
direction = "forward")
summary(modelA)
#Tainan 1-8 + IMPORT6-9(1VARIANT) AIC: 351.56
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:8) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I6_9"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/登革熱資料)
local_Kaohsiung <- read.csv("local-Kaohsiung.csv")
loca_yr_Kaohsiung <- aggregate(local~year, data=local_Kaohsiung, sum)
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','T8','R1','R2','R3','R4','R5','R6','R7','R8','I6_9')
df$CASES <- loca_yr_Kaohsiung2$local
dfnew <- df
#Calculating AIC
glm13 <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + T8 + R1 + R2 + R3 + R4 + R5 + R6 + R7 + R8 + I6_9,
direction = "forward", family=poisson(link=log))
summary(glm13)
#Tainan 1-8 + IMPORT4-7 AIC: 356.88
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:8) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 4:7)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"IMPORT"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/???鞈??")
local_Tainan <- read.csv("local-Tainan.csv")
loca_yr_Tainan <- aggregate(local~year, data=local_Tainan, sum)
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','T8','R1','R2','R3','R4','R5','R6','R7','R8','0','0','0','I4','I5','I6','I7')
df$CASES <- loca_yr_Tainan$local
dfnew <- df
#Calculating AIC
model<- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + T8 + R1 + R2 + R3 + R4 + R5 + R6 + R7 + R8 + I4 + I5 + I6 + I7 ,
direction = "forward", family=poisson(link=log))
summary(model)
#Tainan 1-8 + IMPORT4-7(1VARIANT) AIC: 352.35
setwd("~/weather data")
data <- read.csv("1999-2018 TainanRMAX+TMIN.csv", sep = ",", header = TRUE)
library('MASS')
startyear <- 1999
T <- 0
R <- 0
I <- 0
df <- data.frame()
for (YEAR in 1999:2015) {
print(YEAR)
for (MONTH in 1:8) {
T[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"TMIN"]
R[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"RMAX"]
for (MONTH in 1)
I[MONTH] <- data[data$MONTH==MONTH & data$YEAR==YEAR,"I4_7"]
}
df <- rbind(df, c(YEAR,1,T , R, I))
}
setwd("~/???鞈??")
local_Kaohsiung <- read.csv("local-Kaohsiung.csv")
loca_yr_Kaohsiung <- aggregate(local~year, data=local_Kaohsiung, sum)
names(df)<-c('YEAR','CASES','T1','T2','T3','T4','T5','T6','T7','T8','R1','R2','R3','R4','R5','R6','R7','R8','I4_7')
df$CASES <- loca_yr_Kaohsiung2$local
dfnew <- df
#Calculating AIC
modelB <- stepAIC(glm(CASES ~ 1, data = dfnew),
scope = CASES ~ T1 + T2 + T3 + T4 + T5 + T6 + T7 + T8 + R1 + R2 + R3 + R4 + R5 + R6 + R7 + R8 + I4_7,
direction = "forward", family=poisson(link=log))
summary(modelB)
resA = residuals(modelA, type = "deviance")
resB = residuals(modelB, type = "deviance")
resC = residuals(modelC, type = "deviance")
par(mfrow = c(1,2))
qqnorm(resA)
qqnorm(resB)
par(mfrow = c(2,2))
plot(fitted(glm11), res11)
plot(fitted(glm12), res12)
qqnorm(res11 )
qqnorm(res12)
shapiro.test(res11)
shapiro.test(res12)
library(Matrix)
library(lme4)
library(DHARMa)
resDHARMa = simulateResiduals(glm14)
plot(resDHARMa)
#https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html#formal-goodness-of-fit-tests-on-the-scaled-residuals
#http://www.stat.nthu.edu.tw/~swcheng/Teaching/stat5230/lab/03.01_Count_PoissonRegression.html
#https://github.com/florianhartig/DHARMa/blob/master/Code/Examples/DevianceResiduals.md
